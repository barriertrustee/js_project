const container=document.querySelector(".container"),killScreen=document.querySelector(".kill-screen-container"),h1killScreen=document.querySelector(".kill-screen h1"),resetButton=document.querySelector(".kill-screen button");let numberOfRows=23,numberOfColumns=48,containerWidth=window.innerWidth,containerHeight=window.innerHeight;for(container.style.width=`${containerWidth}px`,container.style.height=`${containerHeight}px`,container.style.gridTemplateColumns=`repeat(${numberOfColumns}, 1fr)`,container.style.gridTemplateRows=`repeat(${numberOfRows}, 1fr)`,i=0;i<numberOfRows*numberOfColumns;i++){let containerBlocki=document.createElement("button");containerBlocki.className="grid-block",container.append(containerBlocki)}const containerBlock=document.querySelectorAll(".grid-block");let containerBlockWidth=Number(getComputedStyle(containerBlock[1]).width.replace("px","")),numberOfMines=50;for(i=0;i<numberOfMines;i){let positionX=Math.ceil(Math.random()*numberOfColumns),positionY=Math.ceil(Math.random()*numberOfRows);"grid-block mines"!==containerBlock[(positionY-1)*numberOfColumns+positionX-1].className&&(i++,containerBlock[(positionY-1)*numberOfColumns+positionX-1].className="grid-block mines",containerBlock[(positionY-1)*numberOfColumns+positionX-1].values=-1)}const mines=document.querySelectorAll(".mines");let gridMap=[];for(i=0;i<numberOfColumns*numberOfRows;i++){let object={block:containerBlock[i],values:0};"grid-block mines"===containerBlock[i].className&&(object.values=-1),gridMap.push(object)}function creatingSurroundingMap(map=[],indexNumber,arrayToModified){return arrayToModified=[map[indexNumber-numberOfColumns-1],map[indexNumber-numberOfColumns],map[indexNumber-numberOfColumns+1],map[indexNumber-1],map[indexNumber],map[indexNumber+1],map[indexNumber+numberOfColumns-1],map[indexNumber+numberOfColumns],map[indexNumber+numberOfColumns+1]],indexNumber%numberOfColumns==0&&arrayToModified.forEach(button=>{if(button===map[indexNumber-numberOfColumns-1]||button===map[indexNumber-1]||button===map[indexNumber+numberOfColumns-1]){let posNumber=arrayToModified.indexOf(button);arrayToModified.splice(posNumber,1)}}),indexNumber%numberOfColumns==numberOfColumns-1&&arrayToModified.forEach(button=>{if(button===map[indexNumber-numberOfColumns+1]||button===map[indexNumber+1]||button===map[indexNumber+numberOfColumns+1]){let posNumber=arrayToModified.indexOf(button);arrayToModified.splice(posNumber,1)}}),arrayToModified}gridMap.forEach(object=>{if(-1===object.values)return;let surroundingBlockArr=[];surroundingBlockArr=creatingSurroundingMap(gridMap,gridMap.indexOf(object),surroundingBlockArr);let surroundingBomb=0;surroundingBlockArr.forEach(object=>{void 0!==object&&-1===object.values&&surroundingBomb++}),object.values=surroundingBomb,object.block.innerHTML=object.values});let recordPos=[];function revealZeroValue(map=[],object=new Object){let i=map.indexOf(object);if(recordPos.includes(i))return;recordPos.push(i);let surroundingBlockArr=[];surroundingBlockArr=creatingSurroundingMap(gridMap,i,surroundingBlockArr),surroundingBlockArr.forEach(button=>{if(void 0===button)return;button.block.style.border="1px solid rgb(0, 0, 0)",button.block.style.fontSize=`${70*containerBlockWidth/100}px`,button.block.disabled="true";let dangerColor=["lightgray","hsl(240, 100%, 50%)","hsl(120,100%,20.8%)","hsl(42.7,100%,23.1%)","hsl(19.4,100%,32.2%)","hsl(0,100%,36.5%)","hsl(0, 100%, 35%)","hsl(0, 100%, 10%)","black"];for(i=0;i<dangerColor.length;i++)button.block.innerHTML==i&&(button.block.style.color=dangerColor[i]);nonMinesBomb.includes(button.block)||nonMinesBomb.push(button.block)}),surroundingBlockArr.forEach(button=>{void 0!==button&&0===button.values&&button!==object&&revealZeroValue(gridMap,button)}),nonMinesBomb.length===containerBlock.length-mines.length&&(killScreen.style.display="flex",h1killScreen.innerHTML="You win ðŸ˜Š")}let nonMinesBomb=[],mistakenFlags=[];gridMap.forEach(object=>{object.block.addEventListener("click",()=>{if(-1===object.values)return;if(0===object.values)return void revealZeroValue(gridMap,object);nonMinesBomb.push(object.block),object.block.style.fontSize=`${70*containerBlockWidth/100}px`,object.block.style.border=".5px solid rgb(0, 0, 0)";let dangerColor=["lightgray","hsl(240, 100%, 50%)","hsl(120,100%,20.8%)","hsl(42.7,100%,23.1%)","hsl(10,100%,32.2%)","hsl(0,100%,36.5%)","hsl(0, 100%, 35%)","hsl(0, 100%, 10%)","black"];for(i=0;i<dangerColor.length;i++)object.block.innerHTML==i&&(object.block.style.color=dangerColor[i]);object.block.disabled="true",nonMinesBomb.length===containerBlock.length-mines.length&&(killScreen.style.display="flex",h1killScreen.innerHTML="You win ðŸ˜Š")}),object.block.addEventListener("contextmenu",e=>{e.preventDefault(),object.block.innerText="";let flagImg=document.createElement("img");flagImg.src="flag.png",object.block.append(flagImg),object.block.disabled="true",object.block.style.border=".5px solid rgb(0, 0, 0)",-1!==object.values&&mistakenFlags.push(object.block)})}),mines.forEach(block=>{block.addEventListener("click",()=>{mines.forEach(block=>{if(!0===block.disabled)return;block.innerHTML="",block.style.border=".5px solid rgb(0, 0, 0)",block.style.backgroundColor="red";let mineBombImg=document.createElement("img");mineBombImg.src="bomb.png",block.appendChild(mineBombImg),killScreen.style.display="flex",h1killScreen.innerHTML="You lose ðŸ˜¢"}),mistakenFlags.forEach(block=>{block.innerHTML="",block.style.backgroundColor="red";let mineBombImg=document.createElement("img");mineBombImg.src="bomb.png",block.appendChild(mineBombImg),block.innerHTML="",block.className="grid-block mines mistaken-flags"})})}),resetButton.addEventListener("click",()=>{window.location.reload()});